# airflow-values.yaml
# Pin to Airflow 3.1
airflowVersion: "3.1.0"
defaultAirflowTag: "3.1.0"

executor: "KubernetesExecutor"

postgresql:
  enabled: false

# Configure external PostgreSQL connection
data:
  metadataConnection:
    user: airflow
    pass: airflow123
    protocol: postgresql
    host: postgres-external
    port: 5432
    db: airflow
    sslmode: disable

dags:
  persistence:
    enabled: true
    size: 5Gi

# Logs persistence using hostPath (single-node K3s)
logs:
  persistence:
    enabled: true
    existingClaim: airflow-logs

webserver:
  replicas: 1
  defaultUser:
    enabled: true
    username: admin
    email: admin@example.com
    firstName: Admin
    lastName: User
    password: admin

config:
  core:
    load_examples: 'false'
  webserver:
    expose_config: 'true'

# Note: Airflow 3.1 supports extraPipPackages in newer Helm charts
# For dag-factory support, consider using extraPipPackages parameter
